<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Visualize your finances with SavePath charts and graphs. Gain insights into spending, savings, and progress.">
  <title>Save Path - Visuals</title>
  <link rel="stylesheet" href="css/project.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .visuals-container {
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
      padding: 60px;
    }

    .visuals-text {
      max-width: 500px;
      margin-right: 60px;
      text-align: left;
    }

    .visuals-text h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 3rem;
      color: var(--accent);
      margin-bottom: 20px;
    }

    .visuals-text p {
      font-size: 1.5rem;
      line-height: 1.6;
      color: var(--text-light);
    }

    .visuals-chart {
      flex: 1;
      max-width: 700px;
    }

    .graph-container {
      display: none;
    }

    .graph-container.active {
      display: block;
    }

    .chart-buttons {
      display: flex;
      justify-content: center;
      margin-top: 20px;
      gap: 20px;
    }

    .chart-buttons button {
      background-color: var(--primary);
      color: var(--white);
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .chart-buttons button:hover {
      background-color: var(--accent);
    }

    .graph-container canvas {
      max-width: 100%;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="wrapper">
    <header>
      <h1 class="site-title">Save Path</h1>
      <nav class="top-nav">
        <a href="index.html" class="home-link">Home</a>
        <a href="dashboard.html" class="nav-link">Dashboard</a>
        <a href="visuals.html" class="nav-link">Visuals</a>
        <a href="goals.html" class="nav-link">Goals</a>
        <a href="calendar.html" class="nav-link">Calendar</a>
        <a href="product.html" class="nav-link">Product</a>
        <a href="quickadd.html" class="quick-add-btn">+ Quick Add</a>
      </nav>
    </header>

    <main>
      <section class="visuals-container">
        <!-- Right side heading + paragraph -->
        <div class="visuals-text">
          <h2>Visuals</h2>
          <p>View graphs and charts summarizing your financial data for better insight into your spending habits.</p>
        </div>

        <!-- Chart + buttons -->
        <div class="visuals-chart">
          <div id="incomeGraph" class="graph-container">
            <h3>Income Over Time</h3>
            <canvas id="incomeChart"></canvas>
          </div>

          <div id="expenseGraph" class="graph-container">
            <h3>Expenses Over Time</h3>
            <canvas id="expenseChart"></canvas>
          </div>

          <div id="summaryGraph" class="graph-container">
            <h3>Income vs Expenses Summary</h3>
            <canvas id="summaryChart"></canvas>
          </div>

          <!-- Buttons under chart -->
          <div class="chart-buttons">
            <button id="income-graph">Income Graph</button>
            <button id="expenses-graph">Expenses Graph</button>
            <button id="summary-chart">Summary Chart</button>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 Save Path | All Rights Reserved<br>Contact us: <strong>777-888-9999</strong></p>
    </footer>
  </div>

  <script>
  const transactions = JSON.parse(localStorage.getItem('transactions')) || [];

  function cssVar(name) {
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
  }

  function groupByMonth(type) {
    const monthly = {};
    transactions.forEach(tx => {
      if (tx.type === type) {
        const month = tx.date.slice(0, 7); // YYYY-MM
        monthly[month] = (monthly[month] || 0) + Number(tx.amount);
      }
    });
    return monthly;
  }

  function renderModernBarChart(ctxId, label, dataObj, colorVar) {
    const ctx = document.getElementById(ctxId).getContext('2d');
    return new Chart(ctx, {
      type: 'bar',
      data: {
        labels: Object.keys(dataObj),
        datasets: [{
          label: label,
          data: Object.values(dataObj),
          backgroundColor: cssVar(colorVar) + 'cc', // semi-transparent
          borderRadius: 6, // rounded corners
          barPercentage: 0.6, // thinner bars
          categoryPercentage: 0.8 // spacing between groups
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            labels: {
              color: cssVar('--text-light'),
              font: {
                family: 'Inter, sans-serif',
                weight: '600'
              }
            }
          },
          title: {
            display: true,
            text: label,
            color: cssVar('--primary'),
            font: {
              family: 'Orbitron, sans-serif',
              size: 18
            }
          }
        },
        scales: {
          x: {
            ticks: {
              color: cssVar('--text-dark')
            },
            grid: {
              display: false // cleaner look
            }
          },
          y: {
            beginAtZero: true,
            ticks: {
              color: cssVar('--text-dark')
            },
            grid: {
              color: 'rgba(255,255,255,0.1)' // subtle grid lines
            }
          }
        },
        animation: {
          duration: 800,
          easing: 'easeOutQuart'
        }
      }
    });
  }

  function renderSummaryModernBarChart() {
    const incomeTotal = transactions.filter(tx => tx.type === 'income')
                                    .reduce((sum, tx) => sum + Number(tx.amount), 0);
    const expenseTotal = transactions.filter(tx => tx.type === 'expense')
                                     .reduce((sum, tx) => sum + Number(tx.amount), 0);
    const ctx = document.getElementById('summaryChart').getContext('2d');
    return new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Income', 'Expenses'],
        datasets: [{
          label: 'Total',
          data: [incomeTotal, expenseTotal],
          backgroundColor: [cssVar('--primary') + 'cc', cssVar('--white') + 'cc'],
          borderRadius: 6,
          barPercentage: 0.5,
          categoryPercentage: 0.7
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            labels: {
              color: cssVar('--text-light'),
              font: {
                family: 'Inter, sans-serif',
                weight: '600'
              }
            }
          },
          title: {
            display: true,
            text: 'Income vs Expenses',
            color: cssVar('--primary'),
            font: {
              family: 'Orbitron, sans-serif',
              size: 18
            }
          }
        },
        scales: {
          x: {
            ticks: {
              color: cssVar('--text-dark')
            },
            grid: { display: false }
          },
          y: {
            beginAtZero: true,
            ticks: {
              color: cssVar('--text-dark')
            },
            grid: {
              color: 'rgba(255,255,255,0.1)'
            }
          }
        },
        animation: {
          duration: 800,
          easing: 'easeOutQuart'
        }
      }
    });
  }

  // Render charts
  const incomeChart = renderModernBarChart('incomeChart', 'Monthly Income', groupByMonth('income'), '--primary');
  const expenseChart = renderModernBarChart('expenseChart', 'Monthly Expenses', groupByMonth('expense'), '--white');
  const summaryChart = renderSummaryModernBarChart();

  // Graph toggle logic
  function showGraph(id) {
    document.querySelectorAll('.graph-container').forEach(div => {
      div.classList.remove('active');
    });
    document.getElementById(id).classList.add('active');
  }

  document.getElementById('income-graph').onclick = () => showGraph('incomeGraph');
  document.getElementById('expenses-graph').onclick = () => showGraph('expenseGraph');
  document.getElementById('summary-chart').onclick = () => showGraph('summaryGraph');

  showGraph('summaryGraph');

  const navSelect = document.getElementById('nav-select');
  if (navSelect) {
    navSelect.addEventListener('change', (e) => {
      const page = e.target.value;
      if (page) {
        window.location.href = page;
      }
    });
  }
</script>
</body>
</html>